#!/usr/bin/env php
<?php
/**
 * Alpha CLI - Laravel Artisan-like Console for Alphavel Framework
 * 
 * Usage:
 *   php alpha list
 *   php alpha serve
 *   php alpha make:controller UserController
 *   php alpha make:model User
 *   php alpha make:resource Post
 *   php alpha cache:clear
 */

require __DIR__ . '/vendor/autoload.php';

// Check if alphavel/alpha package is installed
if (class_exists('Alphavel\\Alpha\\Console\\Application')) {
    // Use full-featured CLI from alphavel/alpha package
    $console = new Alphavel\Alpha\Console\Application();
    exit($console->run());
}

// Fallback to basic CLI if alpha package not installed
if (class_exists('Alphavel\\Framework\\Console\\Console')) {
    // Show info message if listing commands
    if (!isset($argv[1]) || $argv[1] === 'list' || $argv[1] === '--list') {
        echo "\n\033[33mℹ️  Usando comandos básicos do framework\033[0m\n";
        echo "Para acessar todos os comandos avançados, instale:\n";
        echo "  \033[36mcomposer require alphavel/alpha --dev\033[0m\n\n";
    }
    
    $console = new Alphavel\Framework\Console\Console();
    $console->setName('alpha');
    $console->setVersion('1.0.0');
    
    // Auto-discover commands from framework
    if (is_dir(__DIR__ . '/vendor/alphavel/alphavel/Console/Commands')) {
        $console->autodiscover(__DIR__ . '/vendor/alphavel/alphavel/Console/Commands');
    }
    
    // Auto-discover user commands
    if (is_dir(__DIR__ . '/app/Console/Commands')) {
        $console->autodiscover(__DIR__ . '/app/Console/Commands');
    }
    
    exit($console->run($argv));
}

// No CLI available
echo "\n❌ Alpha CLI not found!\n\n";
echo "Install CLI tools:\n";
echo "  composer require alphavel/alpha --dev\n\n";
exit(1);
